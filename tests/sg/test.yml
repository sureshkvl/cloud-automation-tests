---
- name: "testing"
  gather_facts: false
  become: true
  hosts: sg_vm1
  tasks:

  - name: ping the sg vm2 server
    shell: "ping -c 5 {{sg_vm2_ip}} "
    ignore_errors: true
    register: ping_result

  - name: print the ping result     
    debug: var=ping_result

  - name: update the security group to block ping
    delegate_to: localhost
    os_security_group:
      cloud: tenant1
      state: absent
      name: sg_secgroup_backend  

  - name: ping the sg vm2 server
    shell: "ping -c 5 {{sg_vm2_ip}} "
    ignore_errors: true
    register: ping_result

  - name: print the ping result     
    debug: var=ping_result
    


#  - name: validate the ping result     
#    fail: 
#      msg: "Failed response is not correct"
#    when: ping_result.stdout contains 