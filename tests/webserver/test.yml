---
- name: "testing"
  gather_facts: false
  become: true
  hosts: bastionvm
  tasks:
  - name: curl query
    shell: "curl -m 1 {{server_ip}} "
    ignore_errors: true
    register: curl_result

  - name: print the curl result     
    debug: var=curl_result

  - name: validate the curl result     
    fail: 
      msg: "Failed response is not correct"
    when: curl_result.stdout != "vm2"

    
